Главный конфигурационный фаил

Загружается в первую очередь

#ServerRoot "/etc/apache2" корневой каталог конфигурации сервера, где искать свое конфиги

Mutex file:${APACHE_LOCK_DIR} default - механизм исключений переменные находятся в файле envvars

PidFile ${APACHE_PID_FILE} задает путь к файлу в котором сервер должен записать свой процесс: идентификационный номер, когда она начинается.

Timeout 300 задает количество секунд, в течение которых Apache будет ждать завершения обработки операций ввода или вывода для запроса перед отказам клиенту.
            По истечении этого времени, если процесс не завершиться, Apache выдаст отказ в
            обработке запроса по таймауту.
            По умолчанию значение установлено как 5 минут, что вполне достаточно для работы
            большинства скриптов и для получения входящих данных.
            Если у вас нет "тяжелых" сценариев, то можно это время уменьшить, например,
            до 180 секунд (3 минуты).

KeepAlive On Директива KeepAlive определяет разрешать или нет удержание соединения с
             клиентом в активном состоянии, для выполнения нескольких запросов.

MaxKeepAliveRequests 100 MaxKeepAliveRequests задает максимально допустимое количество запросов
                         внутри одного открытого активного соединения с клиентом.
                         Если установить в 0, то количество запросов для открытого соединения будет
                         не ограничено. Это даже рекомендовано.
KeepAliveTimeout 5 задает время в секундах удержания соединения активным
                   в ожидании запроса клиента, т.е. максимальное время простоя активного соединения.

User ${APACHE_RUN_USER}  Директивы User и Group задают имя пользователя и имя группы пользователя от
                         имени, которых Apache будет обрабатывать запрошенные клиентом файлы и ресурсы.
Group ${APACHE_RUN_GROUP}

                        Если у вас PHP работает как модуль Apache, то php файлы будут обрабатываться от
                        имени указанных User и Group. Учитывайте это при настройке прав на каталоги сайта.
                        AssignUserId назначить USER GROUP конкретно для данного виртуального хоста.
                        libapache2-mpm-itk
                        <IfModule mpm_itk_module>
                            AssignUserId USER GROUP
                        </IfModule>

HostnameLookups Off Если директива HostnameLookups включена, то при записи сообщения в лог файл
                    Apache будет указывать доменное имя клиента. Если директива выключена,
                    то Apache будет указывать только IP-адрес клиента в лог файле.
                    Например, www.apache.org (on) или 205.60.128.130 (off).

ErrorLog ${APACHE_LOG_DIR}/error.log задает расположение общего файла журнала ошибок и его имя.
LogLevel warn Директива LogLevel определяет уровень сообщений для записи в лог файл указанный
              в директиве ErrorLog. Если указать уровень warn, то будут записаны все сообщения
              уровня warn(сообщения), error(ошибки), crit(критические), alert(предупреждения),
              emerg(авария).

# Подключение директорий с конфигами модулей, для загрузки их конфигураций
# Пути указаны относительные по отношению к ServerRoot "/etc/apache2"
IncludeOptional mods-enabled/*.load
IncludeOptional mods-enabled/*.conf

# Подключение файла с директивами задания портов.
# Путь указан относительно ServerRoot "/etc/apache2"
Include ports.conf

Разграничение каталогов файловой системы сервера, задача минимальная защищенность

<Directory /> корень сервера что запрещено всем
    Options FollowSymLinks разрешает серверу открывать символьные ссылки
    AllowOverride None НЕ читать файлы .htaccess в локальных директориях
    Require all denied  Запрет доступа для всех
</Directory>

<Directory /usr/share> что разрешено всем
    # Блок разрешает доступ для всех к директории /usr/share в файловой системе
    AllowOverride None  # НЕ читать файлы .htaccess в локальных директориях
    Require all granted # Разрешить доступ всем
</Directory>

<Directory /var/www/>
    # Indexes - разрешить выводить в браузере список файлов директории
    # FollowSymLinks - разрешает серверу открывать символьные ссылки
    Options Indexes FollowSymLinks
    AllowOverride None # НЕ читать файлы .htaccess в локальных директориях
    Require all granted # Разрешить доступ всем
</Directory>

AccessFileName .htaccess
                         устанавливает имя (только имя) файла, который Apache
                         будет искать в каждом каталоге сайта. Этот файл используется для директив


Блок кода в директиве FilesMatch устанавливает запрет доступа к файлам вида
# .htaccess и .htpasswd веб-клиентам
<FilesMatch "^\.ht">
    # Запретить доступ всем
    Require all denied
</FilesMatch>

LogFormat задает формат строк лога доступа (CustomLog) и имя этого
# формата для использования его в директиве

LogFormat "%v:%p %h %l %u %t \"%r\" %>s %O \"%{Referer}i\" \"%{User-Agent}i\"" vhost_combined
LogFormat "%h %l %u %t \"%r\" %>s %O \"%{Referer}i\" \"%{User-Agent}i\"" combined
LogFormat "%h %l %u %t \"%r\" %>s %O" common
LogFormat "%{Referer}i -> %U" referer
LogFormat "%{User-agent}i" agent

# Подключение конфигурационных файлов из каталога conf-enabled домашней
# директории Apache
IncludeOptional conf-enabled/*.conf

# Подключение конфигурационных файлов виртуальных хостов из каталога
# sites-enabled директории Apache
IncludeOptional sites-enabled/*.conf


// Итого сначала стартуют модули потом конфигурация модулей далее вирт хосты